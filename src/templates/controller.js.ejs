<?php

namespace App\Http\Controllers\<%= props.spaceFirst %>;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use <%= props.nameModelSpace _%>\<%= props.nameCapitalize %>;

class <%= props.nameCapitalize %>Controller extends Controller
{
    public function index()
    {	
    	$data = ['<%= props.name %>s'];
    	$<%= props.name %>s = <%= props.nameCapitalize %>::orderBy('id', 'desc')->get();
    	return view('<%= props.space %>.<%= props.name %>.index', compact($data));
    }

    public function form($id = null)
    {
    	$data = ['<%= props.name %>', 'id'];
    	$<%= props.name %> = <%= props.nameCapitalize %>::find($id);
    	return view('<%= props.space %>.<%= props.name %>.form', compact($data));
    }

    public function create(Request $request)
    {
    	$input = $request->except('_token');
        $<%= props.name %> = <%= props.nameCapitalize %>::create($input);
        if ($<%= props.name %>) 
        {
           return redirect()
                ->route('<%= props.space %>.<%= props.name %>.index')
    			->with('msg', 'Cadastrado com sucesso.')
    			->with('error', false);
    	}
        return redirect()
            ->route('<%= props.space %>.<%= props.name %>.form')
    		->with('msg', 'Falha na operação.')
            ->with('error', true)
            ->withInput();
    }

    public function update(Request $request, $id)
    {
    	$input = $request->except('_token', 'imagem');
        $<%= props.name %> = <%= props.nameCapitalize %>::find($id);
        if ($<%= props.name %>) 
        {
            if($<%= props.name %>->update($input))
            {
                return redirect()
                ->route('<%= props.space %>.<%= props.name %>.index')
    			->with('msg', 'Atualizado com sucesso.')
    			->with('error', false);
    		}
            return redirect()
                ->route('<%= props.space %>.<%= props.name %>.form')
                ->with('msg', 'Falha na operação.')
                ->with('error', true)->withInput();
    	}
        return redirect()
            ->route('<%= props.space %>.<%= props.name %>.form')
    		->with('msg', 'Falha na operação.')
    		->with('error', true)->withInput();
    }

    public function destroy($id)
    {
    	$<%= props.name %> = <%= props.nameCapitalize %>::find($id);
        if ($<%= props.name %>) 
        {
    		$<%= props.name %>->delete();
            return redirect()
                ->route('<%= props.space %>.<%= props.name %>.index')
    			->with('msg', 'Deletado com sucesso.')
    			->with('error', false);
    	}
        return redirect()
            ->route('<%= props.space %>.<%= props.name %>.index')
    		->with('msg', 'Falha na operação.')
    		->with('error', true);
    }


}
