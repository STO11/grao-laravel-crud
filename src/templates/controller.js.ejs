<?php

namespace App\Http\Controllers\Controle;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use App\Models\<%= props.nameCapitalize %>;

class <%= props.nameCapitalize %>Controller extends Controller
{
    public function index()
    {	
    	$data = ['<%= props.name %>s'];
    	$<%= props.name %>s = Banner::orderBy('id', 'desc')->get();
    	return view('controle.<%= props.name %>s.index', compact($data));
    }

    public function form($id = null)
    {
    	$data = ['<%= props.name %>'];
    	$<%= props.name %> = <%= props.nameCapitalize %>::find($id);
    	return view('controle.<%= props.name %>s.form', compact($data));
    }

    public function cadastrar(Request $request)
    {
    	$input = $request->except('_token');
        $<%= props.name %> = <%= props.nameCapitalize %>::create($input);
        if ($<%= props.name %>) 
        {
           return redirect()
                ->route('controle.<%= props.name %>s.index')
    			->with('msg', 'Cadastrado com sucesso.')
    			->with('error', false);
    	}
        return redirect()
            ->route('controle.<%= props.name %>.form')
    		->with('msg', 'Falha na operação.')
            ->with('error', true)
            ->withInput();
    }

    public function alterar(Request $request, $id)
    {
    	$input = $request->except('_token', 'imagem');
        $<%= props.name %> = <%= props.nameCapitalize %>::find($id);
        if ($<%= props.name %>) 
        {
            if($<%= props.name %>->update($input))
            {
                return redirect()
                ->route('controle.<%= props.name %>s.index')
    			->with('msg', 'Atualizado com sucesso.')
    			->with('error', false);
    		}
            return redirect()
                ->route('controle.<%= props.name %>s.form')
                ->with('msg', 'Falha na operação.')
                ->with('error', true)->withInput();
    	}
        return redirect()
            ->route('controle.<%= props.name %>s.form')
    		->with('msg', 'Falha na operação.')
    		->with('error', true)->withInput();
    }

    public function excluir($id)
    {
    	$<%= props.name %> = Banner::find($id);
        if ($<%= props.name %>) 
        {
    		$<%= props.name %>->delete();
            return redirect()
                ->route('controle.<%= props.name %>s.index')
    			->with('msg', 'Deletado com sucesso.')
    			->with('error', false);
    	}
        return redirect()
            ->route('controle.<%= props.name %>s.index')
    		->with('msg', 'Falha na operação.')
    		->with('error', true);
    }


}
